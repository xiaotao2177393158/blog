var R=Object.defineProperty,$=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var U=(l,o,e)=>o in l?R(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e,w=(l,o)=>{for(var e in o||(o={}))E.call(o,e)&&U(l,e,o[e]);if(D)for(var e of D(o))N.call(o,e)&&U(l,e,o[e]);return l},S=(l,o)=>$(l,B(o));import{_ as V,u as T,a as G,h as q}from"./index.b33bcfe7.js";import{a0 as C,r as I,t as j,d as i,e as k,n as z,w as n,g as f,j as a,f as F,_ as g,b as h,k as y,o as x,a7 as M,a8 as O,a9 as H,i as J,p as K,l as L}from"./vendor.aa159a5f.js";const Q={name:"DialogAddSwiper",props:{type:String,reload:Function},setup(l){const o=C(null),e=I({uploadImgServer:T,token:G("token")||"",visible:!1,ruleForm:{url:"",link:"",sort:""},rules:{url:[{required:"true",message:"\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],sort:[{required:"true",message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),r=t=>{h.get(`/carousels/${t}`).then(c=>{e.ruleForm={url:c.carouselUrl,link:c.redirectUrl,sort:c.carouselRank}})},b=t=>{const c=t.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(c))return g.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},v=t=>{e.ruleForm.url=t.data||""},u=t=>{e.visible=!0,t?(e.id=t,r(t)):e.ruleForm={url:"",link:"",sort:""}},d=()=>{e.visible=!1},s=()=>{o.value.resetFields()},m=()=>{console.log(o.value.validate),o.value.validate(t=>{if(t){if(q(e.ruleForm.link)){g.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}l.type=="add"?h.post("/carousels",{carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{g.success("\u6DFB\u52A0\u6210\u529F"),e.visible=!1,l.reload&&l.reload()}):h.put("/carousels",{carouselId:e.id,carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{g.success("\u4FEE\u6539\u6210\u529F"),e.visible=!1,l.reload&&l.reload()})}})};return S(w({},j(e)),{open:u,close:d,formRef:o,handleBeforeUpload:b,handleUrlSuccess:v,submitForm:m,handleClose:s})}},W=["src"],X={key:1,class:"el-icon-plus avatar-uploader-icon"},Y={class:"dialog-footer"},Z=y("\u53D6 \u6D88"),ee=y("\u786E \u5B9A");function le(l,o,e,r,b,v){const u=i("el-upload"),d=i("el-form-item"),s=i("el-input"),m=i("el-form"),t=i("el-button"),c=i("el-dialog");return k(),z(c,{title:e.type=="add"?"\u6DFB\u52A0\u8F6E\u64AD\u56FE":"\u4FEE\u6539\u8F6E\u64AD\u56FE",modelValue:l.visible,"onUpdate:modelValue":o[3]||(o[3]=p=>l.visible=p),width:"400px",onClose:r.handleClose},{footer:n(()=>[f("span",Y,[a(t,{onClick:o[2]||(o[2]=p=>l.visible=!1)},{default:n(()=>[Z]),_:1}),a(t,{type:"primary",onClick:r.submitForm},{default:n(()=>[ee]),_:1},8,["onClick"])])]),default:n(()=>[a(m,{model:l.ruleForm,rules:l.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:n(()=>[a(d,{label:"\u56FE\u7247",prop:"url"},{default:n(()=>[a(u,{class:"avatar-uploader",action:l.uploadImgServer,accept:"jpg,jpeg,png",headers:{token:l.token},"show-file-list":!1,"before-upload":r.handleBeforeUpload,"on-success":r.handleUrlSuccess},{default:n(()=>[l.ruleForm.url?(k(),F("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:l.ruleForm.url,class:"avatar"},null,8,W)):(k(),F("i",X))]),_:1},8,["action","headers","before-upload","on-success"])]),_:1}),a(d,{label:"\u8DF3\u8F6C\u94FE\u63A5",prop:"link"},{default:n(()=>[a(s,{type:"text",modelValue:l.ruleForm.link,"onUpdate:modelValue":o[0]||(o[0]=p=>l.ruleForm.link=p)},null,8,["modelValue"])]),_:1}),a(d,{label:"\u6392\u5E8F\u503C",prop:"sort"},{default:n(()=>[a(s,{type:"number",modelValue:l.ruleForm.sort,"onUpdate:modelValue":o[1]||(o[1]=p=>l.ruleForm.sort=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])}var oe=V(Q,[["render",le],["__scopeId","data-v-6c3e84de"]]);const te={name:"Swiper",components:{DialogAddSwiper:oe},setup(){const l=C(null),o=C(null),e=I({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add"});x(()=>{r()});const r=()=>{e.loading=!0,h.get("/carousels",{params:{pageNumber:e.currentPage,pageSize:e.pageSize}}).then(t=>{e.tableData=t.list,e.total=t.totalCount,e.currentPage=t.currPage,e.loading=!1})},b=()=>{e.type="add",o.value.open()},v=t=>{e.type="edit",o.value.open(t)},u=t=>{e.multipleSelection=t},d=()=>{if(!e.multipleSelection.length){g.error("\u8BF7\u9009\u62E9\u9879");return}h.delete("/carousels",{data:{ids:e.multipleSelection.map(t=>t.carouselId)}}).then(()=>{g.success("\u5220\u9664\u6210\u529F"),r()})},s=t=>{h.delete("/carousels",{data:{ids:[t]}}).then(()=>{g.success("\u5220\u9664\u6210\u529F"),r()})},m=t=>{e.currentPage=t,r()};return S(w({},j(e)),{multipleTable:l,handleSelectionChange:u,addGood:o,handleAdd:b,handleEdit:v,handleDelete:d,handleDeleteOne:s,getCarousels:r,changePage:m})}},ae=l=>(K("data-v-38f4bf32"),l=l(),L(),l),re={class:"header"},ne=y("\u589E\u52A0"),se=y("\u6279\u91CF\u5220\u9664"),ie=["src"],de=["href"],ce=["onClick"],ue=ae(()=>f("a",{style:{cursor:"pointer"}},"\u5220\u9664",-1));function pe(l,o,e,r,b,v){const u=i("el-button"),d=i("el-popconfirm"),s=i("el-table-column"),m=i("el-table"),t=i("el-pagination"),c=i("el-card"),p=i("DialogAddSwiper"),P=M("loading");return k(),F(O,null,[a(c,{class:"swiper-container"},{header:n(()=>[f("div",re,[a(u,{type:"primary",size:"small",icon:"el-icon-plus",onClick:r.handleAdd},{default:n(()=>[ne]),_:1},8,["onClick"]),a(d,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:r.handleDelete},{reference:n(()=>[a(u,{type:"danger",size:"small",icon:"el-icon-delete"},{default:n(()=>[se]),_:1})]),_:1},8,["onConfirm"])])]),default:n(()=>[H((k(),z(m,{ref:"multipleTable",data:l.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:r.handleSelectionChange},{default:n(()=>[a(s,{type:"selection",width:"55"}),a(s,{label:"\u8F6E\u64AD\u56FE",width:"200"},{default:n(_=>[f("img",{style:{width:"150px",height:"150px"},src:_.row.carouselUrl,alt:"\u8F6E\u64AD\u56FE"},null,8,ie)]),_:1}),a(s,{label:"\u8DF3\u8F6C\u94FE\u63A5"},{default:n(_=>[f("a",{target:"_blank",href:_.row.redirectUrl},J(_.row.redirectUrl),9,de)]),_:1}),a(s,{prop:"carouselRank",label:"\u6392\u5E8F\u503C",width:"120"}),a(s,{prop:"createTime",label:"\u6DFB\u52A0\u65F6\u95F4",width:"200"}),a(s,{label:"\u64CD\u4F5C",width:"100"},{default:n(_=>[f("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:A=>r.handleEdit(_.row.carouselId)},"\u4FEE\u6539",8,ce),a(d,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:A=>r.handleDeleteOne(_.row.carouselId)},{reference:n(()=>[ue]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[P,l.loading]]),a(t,{background:"",layout:"prev, pager, next",total:l.total,"page-size":l.pageSize,"current-page":l.currentPage,onCurrentChange:r.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1}),a(p,{ref:"addGood",reload:r.getCarousels,type:l.type},null,8,["reload","type"])],64)}var fe=V(te,[["render",pe],["__scopeId","data-v-38f4bf32"]]);export{fe as default};
