var $=Object.defineProperty,x=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var S=(e,n,o)=>n in e?$(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,F=(e,n)=>{for(var o in n||(n={}))G.call(n,o)&&S(e,o,n[o]);if(V)for(var o of V(n))E.call(n,o)&&S(e,o,n[o]);return e},k=(e,n)=>x(e,A(n));import{_ as I,h as D}from"./index.b33bcfe7.js";import{a0 as w,r as U,t as N,d as u,e as T,n as P,w as i,g as y,j as t,_ as p,b as f,k as C,u as j,a5 as B,o as q,m as M,a7 as H,f as O,a8 as J,a9 as K,i as L,p as Q,l as W}from"./vendor.aa159a5f.js";const X={name:"DialogAddHotGood",props:{type:String,configType:Number,reload:Function},setup(e){const n=w(null),o=U({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],id:[{required:"true",message:"\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],sort:[{required:"true",message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),d=a=>{f.get(`/indexConfigs/${a}`).then(g=>{o.ruleForm={name:g.configName,id:g.goodsId,link:g.redirectUrl,sort:g.configRank}})},l=a=>{o.visible=!0,a?(o.id=a,d(a)):o.ruleForm={name:"",id:"",link:"",sort:""}},_=()=>{o.visible=!1},s=()=>{n.value.resetFields()},m=()=>{n.value.validate(a=>{if(a){if(D(o.ruleForm.name)||D(o.ruleForm.link)){p.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}if(o.ruleForm.name.length>128){p.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");return}if(o.ruleForm.sort<0||o.ruleForm.sort>200){p.error("\u6392\u5E8F\u503C\u4E0D\u80FD\u5C0F\u4E8E 0 \u6216\u5927\u4E8E 200");return}e.type=="add"?f.post("/indexConfigs",{configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{p.success("\u6DFB\u52A0\u6210\u529F"),o.visible=!1,e.reload&&e.reload()}):f.put("/indexConfigs",{configId:o.id,configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{p.success("\u4FEE\u6539\u6210\u529F"),o.visible=!1,e.reload&&e.reload()})}})};return k(F({},N(o)),{open:l,close:_,formRef:n,submitForm:m,handleClose:s})}},Y={class:"dialog-footer"},Z=C("\u53D6 \u6D88"),ee=C("\u786E \u5B9A");function oe(e,n,o,d,l,_){const s=u("el-input"),m=u("el-form-item"),a=u("el-form"),g=u("el-button"),h=u("el-dialog");return T(),P(h,{title:o.type=="add"?"\u6DFB\u52A0\u5546\u54C1":"\u4FEE\u6539\u5546\u54C1",modelValue:e.visible,"onUpdate:modelValue":n[5]||(n[5]=c=>e.visible=c),width:"400px",onClose:d.handleClose},{footer:i(()=>[y("span",Y,[t(g,{onClick:n[4]||(n[4]=c=>e.visible=!1)},{default:i(()=>[Z]),_:1}),t(g,{type:"primary",onClick:d.submitForm},{default:i(()=>[ee]),_:1},8,["onClick"])])]),default:i(()=>[t(a,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:i(()=>[t(m,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:i(()=>[t(s,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":n[0]||(n[0]=c=>e.ruleForm.name=c)},null,8,["modelValue"])]),_:1}),t(m,{label:"\u8DF3\u8F6C\u94FE\u63A5",prop:"link"},{default:i(()=>[t(s,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":n[1]||(n[1]=c=>e.ruleForm.link=c)},null,8,["modelValue"])]),_:1}),t(m,{label:"\u5546\u54C1\u7F16\u53F7",prop:"id"},{default:i(()=>[t(s,{type:"number",min:"0",modelValue:e.ruleForm.id,"onUpdate:modelValue":n[2]||(n[2]=c=>e.ruleForm.id=c)},null,8,["modelValue"])]),_:1}),t(m,{label:"\u6392\u5E8F\u503C",prop:"sort"},{default:i(()=>[t(s,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":n[3]||(n[3]=c=>e.ruleForm.sort=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])}var ne=I(X,[["render",oe]]);const R={hot:3,new:4,recommend:5},te={name:"Hot",components:{DialogAddGood:ne},setup(){const e=j(),n=B(),o=w(null),d=w(null),l=U({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",configType:3}),_=e.beforeEach(r=>{["hot","new","recommend"].includes(r.name)&&(l.configType=R[r.name],l.currentPage=1,s())});q(()=>{l.configType=R[n.name],s()}),M(()=>{_()});const s=()=>{l.loading=!0,f.get("/indexConfigs",{params:{pageNumber:l.currentPage,pageSize:l.pageSize,configType:l.configType}}).then(r=>{l.tableData=r.list,l.total=r.totalCount,l.currentPage=r.currPage,l.loading=!1})},m=()=>{l.type="add",d.value.open()},a=r=>{l.type="edit",d.value.open(r)},g=r=>{l.multipleSelection=r},h=()=>{if(!l.multipleSelection.length){p.error("\u8BF7\u9009\u62E9\u9879");return}f.delete("/indexConfigs",{data:{ids:l.multipleSelection.map(r=>r.configId)}}).then(()=>{p.success("\u5220\u9664\u6210\u529F"),s()})},c=r=>{f.delete("/indexConfigs",{data:{ids:[r]}}).then(()=>{p.success("\u5220\u9664\u6210\u529F"),s()})},v=r=>{l.currentPage=r,s()};return k(F({},N(l)),{multipleTable:o,handleSelectionChange:g,addGood:d,handleAdd:m,handleEdit:a,handleDelete:h,handleDeleteOne:c,getIndexConfig:s,changePage:v})}},le=e=>(Q("data-v-c24c5f2c"),e=e(),W(),e),ae={class:"header"},re=C("\u589E\u52A0"),ie=C("\u6279\u91CF\u5220\u9664"),de=["href"],se=["onClick"],ce=le(()=>y("a",{style:{cursor:"pointer"}},"\u5220\u9664",-1));function ue(e,n,o,d,l,_){const s=u("el-button"),m=u("el-popconfirm"),a=u("el-table-column"),g=u("el-table"),h=u("el-pagination"),c=u("el-card"),v=u("DialogAddGood"),r=H("loading");return T(),O(J,null,[t(c,{class:"index-container"},{header:i(()=>[y("div",ae,[t(s,{type:"primary",size:"small",icon:"el-icon-plus",onClick:d.handleAdd},{default:i(()=>[re]),_:1},8,["onClick"]),t(m,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:d.handleDelete},{reference:i(()=>[t(s,{type:"danger",size:"small",icon:"el-icon-delete"},{default:i(()=>[ie]),_:1})]),_:1},8,["onConfirm"])])]),default:i(()=>[K((T(),P(g,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:d.handleSelectionChange},{default:i(()=>[t(a,{type:"selection",width:"55"}),t(a,{prop:"configName",label:"\u5546\u54C1\u540D\u79F0"}),t(a,{label:"\u8DF3\u8F6C\u94FE\u63A5"},{default:i(b=>[y("a",{target:"_blank",href:b.row.redirectUrl},L(b.row.redirectUrl),9,de)]),_:1}),t(a,{prop:"configRank",label:"\u6392\u5E8F\u503C",width:"120"}),t(a,{prop:"goodsId",label:"\u5546\u54C1\u7F16\u53F7",width:"200"}),t(a,{prop:"createTime",label:"\u6DFB\u52A0\u65F6\u95F4",width:"200"}),t(a,{label:"\u64CD\u4F5C",width:"100"},{default:i(b=>[y("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:z=>d.handleEdit(b.row.configId)},"\u4FEE\u6539",8,se),t(m,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:z=>d.handleDeleteOne(b.row.configId)},{reference:i(()=>[ce]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[r,e.loading]]),t(h,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:d.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1}),t(v,{ref:"addGood",reload:d.getIndexConfig,type:e.type,configType:e.configType},null,8,["reload","type","configType"])],64)}var fe=I(te,[["render",ue],["__scopeId","data-v-c24c5f2c"]]);export{fe as default};
